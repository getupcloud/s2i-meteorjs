#!/bin/bash

set -e

# nss_wrapper:
if [ -e "/opt/app-root/etc/generate_container_user" ]; then
    source /opt/app-root/etc/generate_container_user
fi

# Runs the nodejs application server.
run_meteor() {
    export PORT=${PORT:-8080}

    if [ -z "${ROOT_URL}" ]; then
        export ROOT_URL="http://${GETUP_APP_NAME}-${GETUP_PROJECT_NAME}.getup.io:${PORT}/"
        echo "No user supplied ROOT_URL. Using default ($ROOT_URL)"
    fi

    cd bundle
    exec meteor node main.js
}

run_meteor
